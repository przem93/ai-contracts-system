{
  "openapi": "3.0.0",
  "paths": {
    "/api": {
      "get": {
        "operationId": "AppController_getHello",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        }
      }
    },
    "/api/neo4j/verify": {
      "get": {
        "operationId": "AppController_verifyNeo4jConnection",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        }
      }
    },
    "/api/contracts": {
      "get": {
        "operationId": "ContractsController_getAllContracts",
        "summary": "Get all contracts",
        "parameters": [],
        "responses": {
          "200": {
            "description": "Returns all contract files with their parsed content",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/ContractFileDto"
                  }
                }
              }
            }
          }
        },
        "tags": [
          "contracts"
        ]
      }
    },
    "/api/contracts/validate": {
      "get": {
        "operationId": "ContractsController_validateContracts",
        "summary": "Validate all contracts",
        "parameters": [],
        "responses": {
          "200": {
            "description": "Returns validation results for all contract files",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ValidationResponseDto"
                }
              }
            }
          }
        },
        "tags": [
          "contracts"
        ]
      }
    },
    "/api/contracts/check-if-contract-modified": {
      "get": {
        "operationId": "ContractsController_checkIfContractsModified",
        "summary": "Check if contract files have been modified",
        "description": "Compares current contract file hashes with stored hashes in Neo4j database to detect modifications, additions, and removals",
        "parameters": [],
        "responses": {
          "200": {
            "description": "Returns information about modified, added, and removed contracts",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CheckModifiedResponseDto"
                }
              }
            }
          },
          "500": {
            "description": "Failed to check contract modifications"
          }
        },
        "tags": [
          "contracts"
        ]
      }
    },
    "/api/contracts/apply": {
      "post": {
        "operationId": "ContractsController_applyContracts",
        "summary": "Apply contract changes to Neo4j database",
        "description": "Validates all contracts first, then applies them to the Neo4j database if validation passes. Clears existing data before applying.",
        "parameters": [],
        "responses": {
          "200": {
            "description": "Contracts successfully applied to database",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApplyResponseDto"
                }
              }
            }
          },
          "400": {
            "description": "Contract validation failed - invalid contracts detected"
          },
          "500": {
            "description": "Failed to apply contracts to database"
          }
        },
        "tags": [
          "contracts"
        ]
      }
    }
  },
  "info": {
    "title": "AI Contracts System API",
    "description": "API for managing and validating technical dependency contracts",
    "version": "1.0",
    "contact": {}
  },
  "tags": [],
  "servers": [],
  "components": {
    "schemas": {
      "ContractFileDto": {
        "type": "object",
        "properties": {
          "fileName": {
            "type": "string",
            "description": "The name of the contract file",
            "example": "example-contract.yml"
          },
          "filePath": {
            "type": "string",
            "description": "The full path to the contract file",
            "example": "/contracts/example-contract.yml"
          },
          "content": {
            "type": "object",
            "description": "The parsed contract content"
          }
        },
        "required": [
          "fileName",
          "filePath",
          "content"
        ]
      },
      "ValidationErrorDto": {
        "type": "object",
        "properties": {
          "path": {
            "type": "string",
            "description": "The path to the field with the validation error",
            "example": "dependencies.0.module_id"
          },
          "message": {
            "type": "string",
            "description": "The validation error message",
            "example": "Referenced module \"users-permissions\" does not exist"
          }
        },
        "required": [
          "path",
          "message"
        ]
      },
      "ValidationFileDto": {
        "type": "object",
        "properties": {
          "filePath": {
            "type": "string",
            "description": "The full path to the contract file",
            "example": "/contracts/example-contract.yml"
          },
          "fileName": {
            "type": "string",
            "description": "The name of the contract file",
            "example": "example-contract.yml"
          },
          "valid": {
            "type": "boolean",
            "description": "Whether the contract file is valid",
            "example": true
          },
          "errors": {
            "description": "List of validation errors (only present if valid is false)",
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ValidationErrorDto"
            }
          }
        },
        "required": [
          "filePath",
          "fileName",
          "valid"
        ]
      },
      "ValidationResponseDto": {
        "type": "object",
        "properties": {
          "valid": {
            "type": "boolean",
            "description": "Whether all contracts are valid",
            "example": true
          },
          "files": {
            "description": "Validation results for each contract file",
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ValidationFileDto"
            }
          }
        },
        "required": [
          "valid",
          "files"
        ]
      },
      "ApplyResponseDto": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "description": "Whether the operation was successful",
            "example": true
          },
          "modulesProcessed": {
            "type": "number",
            "description": "Number of modules processed",
            "example": 5
          },
          "partsProcessed": {
            "type": "number",
            "description": "Number of parts processed",
            "example": 12
          },
          "message": {
            "type": "string",
            "description": "Success or error message",
            "example": "Successfully applied 5 modules and 12 parts to Neo4j"
          }
        },
        "required": [
          "success",
          "modulesProcessed",
          "partsProcessed",
          "message"
        ]
      },
      "ModifiedContractDto": {
        "type": "object",
        "properties": {
          "moduleId": {
            "type": "string",
            "description": "The module ID from the contract",
            "example": "users-get"
          },
          "fileName": {
            "type": "string",
            "description": "The name of the contract file",
            "example": "users-get.yml"
          },
          "filePath": {
            "type": "string",
            "description": "The full path to the contract file",
            "example": "/contracts/users-get.yml"
          },
          "currentHash": {
            "type": "string",
            "description": "The current hash of the contract file",
            "example": "a3d2f1e8b9c7d6e5f4a3b2c1d0e9f8a7b6c5d4e3f2a1b0c9d8e7f6a5b4c3d2e1"
          },
          "storedHash": {
            "type": "string",
            "description": "The stored hash from Neo4j database (null if contract is new)",
            "example": "b4e3d2c1b0a9f8e7d6c5b4a3d2e1f0a9b8c7d6e5f4a3b2c1d0e9f8a7b6c5d4e3",
            "nullable": true
          },
          "status": {
            "type": "string",
            "description": "The status of the contract: 'modified', 'added', or 'removed'",
            "example": "modified",
            "enum": ["modified", "added", "removed"]
          }
        },
        "required": [
          "moduleId",
          "fileName",
          "filePath",
          "currentHash",
          "status"
        ]
      },
      "CheckModifiedResponseDto": {
        "type": "object",
        "properties": {
          "hasChanges": {
            "type": "boolean",
            "description": "Whether any contracts have been modified, added, or removed",
            "example": true
          },
          "totalChanges": {
            "type": "number",
            "description": "Total number of contracts that have changed",
            "example": 3
          },
          "modifiedCount": {
            "type": "number",
            "description": "Number of modified contracts",
            "example": 2
          },
          "addedCount": {
            "type": "number",
            "description": "Number of newly added contracts",
            "example": 1
          },
          "removedCount": {
            "type": "number",
            "description": "Number of removed contracts",
            "example": 0
          },
          "changes": {
            "type": "array",
            "description": "List of contracts that have been modified, added, or removed",
            "items": {
              "$ref": "#/components/schemas/ModifiedContractDto"
            }
          }
        },
        "required": [
          "hasChanges",
          "totalChanges",
          "modifiedCount",
          "addedCount",
          "removedCount",
          "changes"
        ]
      }
    }
  }
}